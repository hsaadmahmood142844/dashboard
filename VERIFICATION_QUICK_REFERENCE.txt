╔════════════════════════════════════════════════════════════════╗
║         DASHBOARD WIDGET LOADING - VERIFICATION GUIDE          ║
╚════════════════════════════════════════════════════════════════╝

┌────────────────────────────────────────────────────────────────┐
│ STEP 1: VERIFY DATABASE (Backend)                             │
└────────────────────────────────────────────────────────────────┘

  Command:
    cd backend
    npm run verify:dashboard

  Expected Output:
    ✓ Widget Types: 11
    ✓ Dashboards: 1
    ✓ Widget Definitions: 10
    ✓ Widgets in "Default Production Dashboard": 10

  Shows Each Widget With:
    - Name (e.g., "OFR KPI Card")
    - Type (e.g., kpi, line_chart, donut_chart)
    - Position (x, y, width, height)
    - Configuration (metric, unit, etc.)

┌────────────────────────────────────────────────────────────────┐
│ STEP 2: VERIFY FRONTEND LOADING (Browser Console)             │
└────────────────────────────────────────────────────────────────┘

  1. Start Application:
     cd backend && npm start
     cd frontend && npm run dev

  2. Open Browser → Dashboard → Press F12

  3. Look for Console Logs:
     🔄 Loading dashboard widgets from database...
     📊 Dashboards received: [...]
     ✅ Selected dashboard: Default Production Dashboard
     📦 Widget layouts loaded: 10
     🎨 Widget configurations from database:
       1. OFR KPI Card (kpi)
          Position: x=0, y=0, w=3, h=2
          Config: {metric: 'ofr', unit: 'l/min'}
       2. WFR KPI Card (kpi)
          ...
       [continues for all 10 widgets]

┌────────────────────────────────────────────────────────────────┐
│ STEP 3: VERIFY API CALLS (Network Tab)                        │
└────────────────────────────────────────────────────────────────┘

  1. Press F12 → Network Tab
  2. Refresh Dashboard
  3. Look for:

     GET /api/dashboards
     Status: 200 OK
     Response: Array with dashboard objects

     GET /api/dashboard-layouts/dashboard/1
     Status: 200 OK
     Response: Array with 10 widget configurations

  4. Click each call → Preview tab → See JSON from database

┌────────────────────────────────────────────────────────────────┐
│ STEP 4: VERIFY VISUAL INDICATOR                               │
└────────────────────────────────────────────────────────────────┘

  On Dashboard Header, look for:
    [✓ 10 widgets loaded] ← Green badge

  This proves:
    - API call succeeded
    - 10 widgets fetched from database
    - Data stored in component state

┌────────────────────────────────────────────────────────────────┐
│ YOUR 10 WIDGETS (Loaded from Database)                        │
└────────────────────────────────────────────────────────────────┘

  KPI Cards (Row 1):
    1. OFR KPI Card          → Position: x=0, y=0, w=3, h=2
    2. WFR KPI Card          → Position: x=3, y=0, w=3, h=2
    3. GFR KPI Card          → Position: x=6, y=0, w=3, h=2
    4. Last Refresh Card     → Position: x=9, y=0, w=3, h=2

  Line Charts (Rows 2-5):
    5. OFR Line Chart        → Position: x=0, y=2, w=6, h=4
    6. WFR Line Chart        → Position: x=6, y=2, w=6, h=4
    7. GFR Line Chart        → Position: x=0, y=6, w=6, h=4
    8. Fractions Chart       → Position: x=0, y=6, w=6, h=4

  Circular Charts (Row 5):
    9. GVF/WLR Donut Charts  → Position: x=6, y=6, w=6, h=4
                                (The circular donut charts you mentioned!)

  Map (Rows 6+):
    10. Production Map       → Position: x=0, y=15, w=12, h=6

┌────────────────────────────────────────────────────────────────┐
│ PROOF CHECKLIST                                                │
└────────────────────────────────────────────────────────────────┘

  □ Backend verification shows 10 widgets in database
  □ Console logs show widget data FROM database
  □ Network tab shows API calls TO database
  □ Green badge shows "10 widgets loaded"
  □ Each widget log shows position (x, y, w, h)
  □ Each widget log shows configuration data
  □ Widget order matches display_order from DB

  If ALL checked → Widgets are 100% loading from database!

┌────────────────────────────────────────────────────────────────┐
│ TROUBLESHOOTING                                                │
└────────────────────────────────────────────────────────────────┘

  Problem: "0 widgets loaded" or no badge
  Fix: npm run seed:dashboard

  Problem: No console logs
  Fix: Check backend is running, auth token valid

  Problem: Database connection error
  Fix: sudo systemctl start postgresql

  Problem: Verification script fails
  Fix: Check DATABASE_URL in backend/.env

┌────────────────────────────────────────────────────────────────┐
│ DIRECT DATABASE QUERY (Optional)                              │
└────────────────────────────────────────────────────────────────┘

  Query:
    psql -U postgres -d saher-dashboard -c "
      SELECT dl.display_order, wd.name, wt.name as type
      FROM dashboard_layouts dl
      JOIN widget_definitions wd ON dl.widget_definition_id = wd.id
      JOIN widget_types wt ON wd.widget_type_id = wt.id
      WHERE dl.dashboard_id = 1
      ORDER BY dl.display_order;
    "

  Expected: List of 10 widgets with order, name, and type

════════════════════════════════════════════════════════════════
For detailed info, see: VERIFICATION_GUIDE.md
════════════════════════════════════════════════════════════════
